import{u as $,A as J,K as l,W as p,B as f,c as V,w as e,$ as x,ab as E,r as R,o as S,b as s,a0 as v,a1 as U,G as z,X as C,h as r,t as i,a9 as L,g as j,v as F,a8 as A,a as G,k as K}from"./app-DlGd_NOW.js";import{u as W}from"./i18nUtils-VWib1heL.js";import{u as X}from"./project-DiB0_pof.js";import{u as q}from"./jobExecution-Dcnq31yo.js";import{_ as M,a as O}from"./UiParentCard.vue_vue_type_script_setup_true_lang-BfSscY-T.js";const le=$({__name:"Show",setup(Q){const{t:n}=J(),_=l([]),T=E(),y=X(),d=q(),P=p(()=>y.project),u=l(null);W(()=>{_.value=[{title:n("jobs.tableHeaderName"),align:"start",key:"name"},{title:n("jobs.tableHeaderTotal"),align:"start",key:"total_jobs"},{title:n("jobs.tableHeaderPending"),align:"start",key:"pending_jobs"},{title:n("jobs.tableHeaderFailed"),align:"start",key:"failed_jobs"},{title:n("jobs.tableHeaderStatus"),align:"start",key:"status"},{title:n("jobs.tableHeaderDate"),key:"created_at"}]}),f(()=>T.params.projectId,(a,o)=>{u.value=parseInt(a),isNaN(u.value)||y.getProjectById(u.value).then(k=>{document.title=n("projects.pageTitle")+" - "+P.value.name})},{immediate:!0});const m=l(""),b=l([]),h=l("created_at"),I=l("desc"),w=p(()=>d.jobExecutions),B=p(()=>d.loading),D=p(()=>d.totalItems),c=l(100),N=l(0),g=({page:a,itemsPerPage:o})=>{N.value=a,d.getJobExecutions({projectId:u.value,page:a,itemsPerPage:o,search:m.value,sortColumn:h.value,sortDirection:I.value})},H=()=>{g({page:0,itemsPerPage:c.value})};return f(c,(a,o)=>{a!==o&&g({page:0,itemsPerPage:a})}),f(b,(a,o)=>{a[0]&&(h.value=a[0].key,I.value=a[0].order)}),(a,o)=>{const k=R("RouterLink");return S(),V(x,null,{default:e(()=>[s(v,{cols:"12"},{default:e(()=>[s(M,{title:P.value.name},{default:e(()=>[s(x,null,{default:e(()=>[s(v,{cols:"12",lg:"4",md:"6"},{default:e(()=>[s(U,{density:"compact",modelValue:m.value,"onUpdate:modelValue":o[0]||(o[0]=t=>m.value=t),label:a.$t("jobs.searchJob"),"prepend-inner-icon":"mdi-magnify",variant:"outlined","hide-details":""},null,8,["modelValue","label"])]),_:1}),s(v,{cols:"12",lg:"8",md:"6",class:"text-right"},{default:e(()=>[s(z,{color:"primary",to:{name:"execute-job",params:{projectId:a.$route.params.projectId}},flat:"",class:"ml-auto"},{default:e(()=>[s(C,{class:"mr-2"},{default:e(()=>o[3]||(o[3]=[r("mdi-database-sync")])),_:1}),r(" "+i(a.$t("jobs.executeJob")),1)]),_:1},8,["to"])]),_:1})]),_:1}),s(L,{headers:_.value,items:w.value,loading:B.value,"items-length":D.value,"items-per-page":c.value,"onUpdate:itemsPerPage":o[1]||(o[1]=t=>c.value=t),"onUpdate:options":g,search:m.value,onSearch:H,"sort-by":b.value,"onUpdate:sortBy":o[2]||(o[2]=t=>b.value=t),"item-value":"name",class:"border rounded-md mt-5"},{"item.name":e(({item:t})=>[s(k,{to:{name:"job-details",params:{jobExecutionId:t.id}},class:"text-primary text-decoration-none text-body-1 font-weight-medium"},{default:e(()=>[r(i(t.name),1)]),_:2},1032,["to"])]),"item.pending_jobs":e(({item:t})=>[s(j,{rounded:"lg",color:"warning",class:"font-weight-bold",size:"small"},{default:e(()=>[r(i(t.pending_jobs),1)]),_:2},1024)]),"item.failed_jobs":e(({item:t})=>[s(j,{rounded:"lg",color:"error",class:"font-weight-bold",size:"small"},{default:e(()=>[r(i(t.failed_jobs),1)]),_:2},1024)]),"item.status":e(({item:t})=>[s(j,{rounded:"md",class:"font-weight-bold",color:F(O)(t.status),size:"small",label:""},{default:e(()=>[r(i(a.$t("jobs.statuses."+t.status)),1)]),_:2},1032,["color"]),t.status==="failed"?(S(),V(A,{key:0,activator:"parent",location:"top"},{activator:e(({props:Z})=>[s(C,null,{default:e(()=>o[4]||(o[4]=[r("mdi-help-circle")])),_:1})]),default:e(()=>[G("span",null,i(t.response),1)]),_:2},1024)):K("",!0)]),"item.created_at":e(({item:t})=>[r(i(new Date(t.created_at).toLocaleString()),1)]),_:1},8,["headers","items","loading","items-length","items-per-page","search","sort-by"])]),_:1},8,["title"])]),_:1})]),_:1})}}});export{le as default};
